name: PR Validation 1

on:
  pull_request:
    types: [opened, synchronize, reopened]

jobs:
  validate-1:
    runs-on: ubuntu-latest
    steps:
      - name: Validation Step
        run: |
          echo "Running PR validation 1"
          echo "No-op validation complete"
      
      - name: Generate Terraform Plan Artifact
        run: |
          mkdir -p terraform-plans
          # Plan with changes to block auto-merge
          cat > terraform-plans/plan1.json <<'EOF'
          {
            "resource_changes": [
              {
                "address": "aws_instance.web",
                "type": "aws_instance",
                "change": {
                  "actions": ["create"]
                }
              }
            ]
          }
          EOF
          # Empty plan
          cat > terraform-plans/plan2.json <<'EOF'
          {
            "resource_changes": []
          }
          EOF
      
      - name: Upload Terraform Plans
        uses: actions/upload-artifact@v4
        with:
          name: terraform-plans-validate-1
          path: terraform-plans/*.json
          retention-days: 1
